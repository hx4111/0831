<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<title>可米酷电影票大派送</title>
	<meta name="keywords" content="可米酷,福利,电影票,大派送,暑期档">
	<meta name="description" content="精彩暑期档,可米酷联合各大影城进行电影票大派送">
	<link rel="stylesheet" type="text/css" href="//at.alicdn.com/t/font_1463478490_8874226.css">
	<link rel="stylesheet" type="text/css" href="http://cdn.icomicool.cn/m/tpl/css/style.min.css">
	<script src="http://cdn.icomicool.cn/m/js/base.min.js" type="text/javascript" charset="utf-8"></script>
	<style>

		.img-list {
			background-color: #ffc851;
		}
		.img-list li {
			position: relative;
		}

		.share-btn {
			position: absolute;
			bottom: .5rem;
			width: 100%;
		}

		.share-btn img {
			margin: 0 auto;
			width: 50%;
		} 

		.go-post {
			position: absolute;
			bottom: .1rem;
			width: 100%;
		}

		.go-post img {
			margin: 0 auto;
			width: 50%;
		}

		.users-list {
			position: relative;
			width: 100%;
		}

		.users-list .list-header {
			display: block;
			margin-left: 1%;
		}

		.users-list .list-header li {
			display: inline-block;
			width: 33%;
			text-align: center;
		}

		.day-item {
			border-radius: 10px;
			width: 80%;
			margin: 0 auto;
			background-color: #e7e822;
		}

		.now-item {
			background-color: #ffefcb;
			color: #ffc750;
		}

		.users-content {
			width: 90%;
			margin-top: 1rem;
			margin-left: 5%;
			background-color: #ffefcb;
			color: #ffc750;
			border-radius: 5px;
			border: 1px solid #ffc750;
		}

		.users-content table {
			width: 100%;
			text-align: center;
		}

		.user-content td {
			overflow: hidden;
			text-overflow:ellipsis;
			white-space: nowrap;
		}

		.users-tip {
			display: none;
			padding: .2rem 1rem;
		}

		.rules-btn {
			position: fixed;
			bottom: 40%;
			right: -0.3rem;
			width: 1rem;
			font-size: .8rem;
			padding: .3rem;
			color: #fff;
			font-weight: bold;
			background-color: #F33529;
			border-radius: 10px 0 0 10px;
			border: 1px solid #fff;
		}

		.rule-content {
			display: none;
			position: fixed;
			top: 20%;
			width: 100%;
			z-index: 11;
			font-size: .8rem;
		}

		.rule-content-inner {
			width: 90%;
			margin: 0 auto;
			background-color: #ffc851;
			color: #fff;
			border: 1px solid #ffc750;
			border-radius: 5px;
			padding: .5rem .3rem;
		}

		.pageCover {
			display: none;
			position: fixed;
			z-index: 10;
			top: 0;
			width: 100%;
			height: 100%;
			background-color: #000;
			opacity: 0.3;
		}

		.post-tip {
			text-align: center;
			color: #D45F50;
		}
	</style>
</head>
<body>
	<header class="header header-fixed header-shadow">
		<a href="http://m.comicool.cn"><i class="l-icon iconfont icon-home"></i></a>
		<i class="r-icon iconfont icon-share share-trigger"></i>
	</header>
	<ul class="img-list">
		<li>
			<img src="http://cdn.icomicool.cn/m/act/201607/movies/images/index_01.jpg" alt="可米酷送电影票啦">
		</li>
		<li>
			<img src="http://cdn.icomicool.cn/m/act/201607/movies/images/index_02.jpg" alt="可米酷送电影票啦">
			<div class="share-btn smart-tip-inst share-trigger">
				<img src="http://cdn.icomicool.cn/m/act/201607/movies/images/share-btn.png" alt="分享送电影票">
			</div>
		</li>
		<li>
			<img src="http://cdn.icomicool.cn/m/act/201607/movies/images/index_03.jpg" alt="可米酷送电影票啦">
			<div class="go-post smart-tip-inst">
				<img src="http://cdn.icomicool.cn/m/act/201607/movies/images/go-post-btn.png" alt="评论送电影票">
			</div>
		</li>
		<div class="post-tip">需在App中评论</div>
		<li><img src="http://cdn.icomicool.cn/m/act/201607/movies/images/index_04.jpg" alt="可米酷送电影票啦"></li>
		<div class="users-list">
			<div class="list-header">
				<li data-did="0">
					<div class="day-item">07-16</div>
				</li><li data-did="1">
					<div class="day-item">07-17</div>
				</li><li data-did="2">
					<div class="day-item">07-18</div>
				</li>
			</div>
			<div class="users-content">
				<table id="users-table"></table>
				<div class="users-tip">
					获奖名单次日中午进行公布，获奖用户敬请留意手机短信哟
				</div>
			</div>
		</div>
		<li><img src="http://cdn.icomicool.cn/m/act/201607/movies/images/index_06.jpg" alt="可米酷送电影票啦"></li>
	</ul>
	<div class="rules-btn">
		规则说明
	</div>
	<div class="rule-content">
		<div class="rule-content-inner">
			<p>特别说明</p>
			<p>1、每天会从满足条件的评论中抽取10名用户发放（万一中了呢）。</p>
			<p>2、电影票奖励是通过短信通知，以数字序列号兑换码的形式发放。</p>
			<p>3、电影票可以登录对应网站进行兑换当下影城正在上映中的电影（不限制电影）。</p>
			<p>4、奖励序列号有效期为60天，建议用户在有效期内进行观看。</p>
			<p>5、特殊场次，如VIP厅、IMAX厅或其他抠电影售价超过85元的场次无法使用。</p>
		</div>
	</div>
	<div class="pageCover"></div>
	<div id="post-and-Ctrl"></div>
	<!-- 百度分享面板 -->
    <div id="ShareBg"></div>
    <div class="bdsharebuttonbox sharebox" data-tag="share_1">
        <div id="ShareCon">
            <em></em>
            <h2></h2>
        </div>
        <div>
            <a data-cmd="tsina"></a><i class="icon-xinlangweibo iconfont"></i>
            <a data-cmd="sqq"></a><i class="icon-qq iconfont" data-cmd="bds_sqq"></i>
            <a data-cmd="qzone"></a><i class="icon-qqkongjian iconfont" data-cmd="bds_qzone"></i>
            <a data-cmd="douban"></a><i class="icon-douban iconfont" data-cmd="bds_douban"></i>
        </div>
        <div class="share-clo">取消</div>
    </div>
<script src="http://cdn.icomicool.cn/m/tpl/dist/act-global.min.js" type="text/javascript"></script>
<script src="users-list.js?_=1467711416233" type="text/javascript"></script>
<script>
	window.onload = function() {
		init();
	}

	function init() {
		var nowDate = new Date().getDate();
		var nowIndex = nowDate - 16;
		if (nowIndex > 3) {
			nowIndex = 3
		}
		if (nowIndex < 0) {
			nowIndex = 0;
		}
		
		renderList(nowIndex-1);
		$('.users-list li').on('click', function() {
			var dataIndex = $(this).data('did');
			renderList(dataIndex);
		})

		$('.go-post').on('click', function() {
			if (CONFIG.isApp) {
				callAppFunction('openPostSend', {
					"post_type":"topic2036",
				});
			} else {
				new TipBox({
                    str: '下载可米酷App才能继续玩耍哦，看更多精彩漫画还能领奖励！', 
                    btnText: ['取消', '确认'], 
                    btnCallback: function() {
                        if (this.innerText == '确认') {
                            window.location.href = 'http://m.app.comicool.cn/smart_open/main.php?ch=prom6';
                        } else {
                            return;
                        }
                    }
                })
			}
		})

		$('.share-btn').on('click', function() {
			if (CONFIG.isApp) {
				callAppFunction('popupSharePanel', {
					"title": "可米酷电影票大派送",
					"describe": "精彩暑期档,可米酷联合各大影城进行电影票大派送",
					"imageurl": "http://cdn.icomicool.cn/m/act/201607/movies/images/movies-share.jpg",
					"page_url": window.location.href
				});
			}
		})

		$('.rules-btn').on('click', function() {
			$('.pageCover').show();
			$('.rule-content').show();
			$('body').css("overflow","hidden");
		})

		$('.rule-content, .pageCover').on('click', function() {
			$('.pageCover').hide();
			$('.rule-content').hide();
			$('body').css("overflow","auto");
		})
	}

	function renderList(index) {
		$('.day-item').removeClass('now-item');
		$('.list-header li').eq(index).find('.day-item').addClass('now-item');

		if (usersList[index]) {
			var tableHtml = '<tr>';
			for (var i=0, len=usersList[index].length; i<len; i++) {
				if ((i % 2 == 0) && (i != 0)) {
					tableHtml += '</tr><tr>'
				}
				tableHtml += '<td>' + usersList[index][i] + '</td>';
			}
			tableHtml += '</tr>';

			$('#users-table').html(tableHtml).show();
			$('.users-tip').hide();
		} else {
			$('#users-table').hide();
			$('.users-tip').show();
		}
	}

	var shareJsonObj = {
        'title' : '可米酷电影票大派送',
        'describe' : '精彩暑期档,可米酷联合各大影城进行电影票大派送',
        'imageUrl' : 'http://cdn.icomicool.cn/m/act/201607/movies/images/movies-share.jpg',
        'pageUrl': window.location.href
    };
    setShareInfo(shareJsonObj, {
        use: 'baidu',
        init: initBaiduSharePanel
    });

    function initBaiduSharePanel() {
        var _ = function(selector, parent) {
                return (parent || document).querySelector(selector);
            },
            header = _('.header'),
            trigger = $('.share-trigger'),
            mask = _('#ShareBg'),
            shareBtn = _('#share-btn'),
            panelTitle = _('#ShareCon h2'),
            panel = _('.bdsharebuttonbox'),
            cancelBtn = _('.share-clo', panel),
            panelImageCont = _('#ShareCon em'),
            panelImage = new Image(),
            hidePanel = function() {
                mask.style.display = panel.style.display = 'none';
            };
        header.style.display = 'block';
        panelTitle.innerHTML = this.title;
        panelImage.src = this.imageUrl;
        panelImageCont.appendChild(panelImage);
        if (CONFIG.isWeixin || CONFIG.isQQ || CONFIG.isWeibo) {
			trigger.on('click', function() {
				document.getElementById('ShareBg').style.display = 'block';
				document.getElementById('ShareBg').innerHTML = '<img src="http://cdn.icomicool.cn/m/images/shareTip.png" >';
				header.style.display = 'none';
			});
			document.getElementById('ShareBg').addEventListener('click', function(){
				document.getElementById('ShareBg').style.display = 'none';
				header.style.display = 'block';
			})
		} else {
			trigger.on('click', function() {
				mask.style.display = panel.style.display = 'block';
			});
			mask.addEventListener('click', hidePanel);
			cancelBtn.addEventListener('click', hidePanel);
		}
    }

    ReactDOM.render(React.createElement(PostAndCtrl, {postType: "topic2036"}), document.getElementById('post-and-Ctrl'));

    var post_all = getQueryString('post_all');
    if (post_all) {

    }

    function getAllPost() {
    	var postData = {
    		postType: 'topic2036',
    		postId: 0
    	};

    	getPostList(postData, 20, function(data) {
    		var postList = data.post_list;
    		var userList = data.user_list;

    		for (var i = 0, len = postList.length; i < len; i++) {
    			var post = postList[i];

    			for (var j = 0, len1 = userList.length; j < len1; j++) {
    				if (post.ccid = userList[j].ccid) {
    					post.nickname = userList[j].nickname;
    					break; 
    				}
    			}

    			console.info(post.ccid + ' /t ' + post.nickname + ' /t ' + post);
    		}
    	})
    }
</script>
<!-- 百度统计 -->
<script>
	var _hmt = _hmt || [];
	(function() {
		var hm = document.createElement("script");
		hm.src = "//hm.baidu.com/hm.js?91ce1b276d999b0757a6bf47b0e86df6";
		var s = document.getElementsByTagName("script")[0];
		s.parentNode.insertBefore(hm, s);
	})();
</script>
</body>
</html>