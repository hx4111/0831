<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>520大声说出我爱你</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
		<meta name="keywords" content="可米酷漫画,漫画app" />
		<meta name="description" content="520大声说出我爱你">
		<link rel="stylesheet" href="http://cdn.icomicool.cn/m/act/act-common/css/common.css?t=20160518">
		<link rel="stylesheet" href="http://at.alicdn.com/t/font_1463386207_0576153.css">
		<script src="http://cdn.icomicool.cn/m/js/base.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="http://m.comicool.cn/m-common/js/init.js"></script>
		<script src="http://cdn.icomicool.cn/m/js/config.js"></script>
		<style type="text/css">
			#praise span {
				color: #F85450;
			}
			
			#toast {
				position: fixed;
				bottom: 2rem;
				left: 50%;
				transform: translate3d(-50%, 0, 0);
				-ms-transform: translate3d(-50%, 0, 0);
				-moz-transform: translate3d(-50%, 0, 0);
				-webkit-transform: translate3d(-50%, 0, 0);
				-o-transform: translate3d(-50%, 0, 0);
				border-radius: .3rem;
				background: #000;
				color: #fff;
				padding: .5rem 1rem;
				text-align: center;
				opacity: .7;
				-webkit-tap-highlight-color: transparent;
				/*The good stuff */
				-webkit-transition: opacity 0.5s ease-out;
				/* Saf3.2+, Chrome */
				-moz-transition: opacity 0.5s ease-out;
				/* FF4+ */
				-ms-transition: opacity 0.5s ease-out;
				/* IE10? */
				-o-transition: opacity 0.5s ease-out;
				/* Opera 10.5+ */
				transition: opacity 0.5s ease-out;
				z-index: 9999;
				font-size: .7rem;
				background: #6B6A6A;
			}
			
			#zan ul {
				float: left;
				width: 50%;
				position: relative;
			}
			
			#zan span {
				position: absolute;
				left: 50%;
				transform: translateX(-50%);
				-webkit-transform: translateX(-50%);
				-o-transform: translateX(-50%);
				-moz-transform: translateX(-50%);
				bottom: 0;
			}
			#oppose span {color: #d12637;}
		</style>
	</head>

	<body>
		<!-- 一般化分享 -->
		<h1 class="thumbnails" style="display:none">
        520大声说出我爱你
        <p>520大声说出我爱你</p>
        <img src="http://cdn.icomicool.cn/m/act/201605/520/images/520_share.jpg">
    </h1>
		<header class="header header-fixed header-shadow">
			<a class="l-icon icon-home iconfont" href="http://m.comicool.cn"></a>
			<i class="r-icon icon-share iconfont"></i>
		</header>
		<!-- 主要内容：开始 -->
		<div id="imglist">

			<li><img src="http://cdn.icomicool.cn/m/act/201605/520/images/index_01.jpg" alt="520大声说出我爱你" /></li>
			<li><img src="http://cdn.icomicool.cn/m/act/201605/520/images/index_02.jpg" alt="520大声说出我爱你" /></li>
			<li data-ccid="10999"><img src="http://cdn.icomicool.cn/m/act/201605/520/images/index_03.jpg" alt="那种甜漫画,那种甜漫画全集" /></li>
			<li data-ccid="11300"><img src="http://cdn.icomicool.cn/m/act/201605/520/images/index_04.jpg" alt="雨后的盛夏漫画,雨后的盛夏漫画全集" /></li>
			<li data-ccid="11186"><img src="http://cdn.icomicool.cn/m/act/201605/520/images/index_05.jpg" alt="我的鬼娃娇妻漫画,我的鬼娃娇妻漫画全集" /></li>
			<li>
				<div id="zan">
					<div>
						<ul id="oppose">
							<span>0</span>
							<img src="http://cdn.icomicool.cn/m/act/201605/520/images/index_06.jpg" alt="520大声说出我爱你" />
						</ul>
						<ul id="support">
							<span>0</span>
							<img src="http://cdn.icomicool.cn/m/act/201605/520/images/index_07.jpg" alt="520大声说出我爱你" />
						</ul>
					</div>
				</div>
			</li>

			<li id="share-btn"><img src="http://cdn.icomicool.cn/m/act/201605/520/images/index_08.jpg" alt="520大声说出我爱你" /></li>
			<li><img src="http://cdn.icomicool.cn/m/act/201605/520/images/index_09.jpg" alt="520大声说出我爱你" /></li>
		</div>
		<div class="discuss_betting">
			<script type="text/template" id="tmpl-discuss">
				<div class="talk_title_betting">
					<span><i class="iconfont icon-liuyan" id="post-counter">{{post_count}}</i></span>
				</div>
				{{if post_list && post_list.length}} {{include 'tmpl-comments'}} {{/if}}
			</script>
		</div>
		<script type="text/template" id="tmpl-comments">
			{{each post_list as item index}}
			<div class="talk_comment" data-id="{{item.post_id}}">
				<li>
					<div class="post-photo">
						<img src="{{item.ccid | getUserInfo:user_list,'icon', 'http://cdn.icomicool.cn/m/act/act-common/images/default_avatar.png'}}">
					</div>
					<h3>{{item.ccid | getUserInfo:user_list,'nickname','酷酱'}}</h3>
					<time>{{item.post_time | date2string}}</time>
				</li>
				<li>
					<p class="comment-content">{{item.post_text}}</p>
				</li>
				<li class="post_rich comment-content">
					{{each item.post_rich as n}} {{if n.img_url}}
					<img src='http://up.cdn.icomico.com/{{n.img_url}}'> {{/if}} {{/each}}
				</li>
				<small><i class="iconfont icon-xin"></i>{{item.praise_count}}</small>
			</div>
			{{/each}}
		</script>
		<div class="publish_betting"></div>
		<!-- 主要内容：结束 -->
		<!-- 百度分享面板 -->
		<div id="ShareBg"></div>
		<div class="bdsharebuttonbox sharebox" data-tag="share_1">
			<div id="ShareCon">
				<em></em>
				<h2></h2>
			</div>
			<div>
				<a data-cmd="tsina"></a><i class="icon-xinlangweibo iconfont"></i>
				<a data-cmd="sqq"></a><i class="icon-qq iconfont" data-cmd="bds_sqq"></i>
				<a data-cmd="qzone"></a><i class="icon-qqkongjian iconfont" data-cmd="bds_qzone"></i>
				<a data-cmd="douban"></a><i class="icon-douban iconfont" data-cmd="bds_douban"></i>
			</div>
			<div class="share-clo">取消</div>
		</div>
		<script src="http://m.comicool.cn/m-common/js/app.js"></script>
		<script src="http://www.comicool.cn/common/js/template.js"></script>
		<script src="js/comment.js"></script>
		<script>
			var shareJsonObj = {
				'title': '520大声说出我爱你',
				'describe': '520大声说出我爱你',
				'imageUrl': 'http://cdn.icomicool.cn/m/act/201605/520/images/520_share.jpg',
				'pageUrl': window.location.href
			};
			setShareInfo(shareJsonObj, {
				use: 'baidu',
				init: initBaiduSharePanel
			});

			function initBaiduSharePanel() {
				var _ = function(selector, parent) {
						return (parent || document).querySelector(selector);
					},
					header = _('.header'),
					trigger = _('.icon-share', header),
					mask = _('#ShareBg'),
					shareBtn = _('#share-btn'),
					panel = _('.bdsharebuttonbox'),
					cancelBtn = _('.share-clo', panel),
					panelTitle = _('#ShareCon h2'),
					panelImageCont = _('#ShareCon em'),
					panelImage = new Image(),
					hidePanel = function() {
						mask.style.display = panel.style.display = 'none';
					};
				header.style.display = 'block';
				panelTitle.innerHTML = this.title;
				panelImage.src = this.imageUrl;
				panelImageCont.appendChild(panelImage);
				trigger.addEventListener('click', function() {
					mask.style.display = panel.style.display = 'block';
				});
				mask.addEventListener('click', hidePanel);
				cancelBtn.addEventListener('click', hidePanel);
			}
			window.onload = function() {
				$("#share-btn img").on("click", function() {
					if (isApp) {
						callAppFunction('popupSharePanel', {
							"title": '520大声说出我爱你',
							"describe": '520大声说出我爱你',
							"imageurl": 'http://cdn.icomicool.cn/m/act/201605/520/images/520_share.jpg',
							"page_url": window.location.href,
							"weibo_describe": "520大声说出我爱你"
						});
					} else {
						$("#ShareBg,.bdsharebuttonbox").show();
					}
				});
				bindOpenComicEvents();
			}
			function bindOpenComicEvents() {
				var readComic;
				if (isAndroidApp) {
					readComic = function(ccid) {
						callAppFunction('openEpisodeReaderPage', {
							comic_id: ccid,
							ep_id: 1
						});
					}
				} else {
					readComic = function(ccid) {
						window.location.href = 'http://m.comicool.cn/content/reader.html?comic_id=' + ccid + '&ep_id=1';
					}
				}
				$("#imglist li,#imglist span").on('click', function(e) {
					var ccid = this.dataset.ccid;
					if (ccid !== undefined && ccid !== "") {
						readComic(ccid);
					}
				});
			}
			var loveYou = {
					hideToast: function() {
						var alert = document.getElementById("toast");
						alert.style.opacity = 0;
						clearInterval(intervalCounter);
					},
					drawToast: function(message) {
						var alert = document.getElementById("toast");
						if (alert == null) {
							var toastHTML = '<div id="toast">' + message + '</div>';
							document.body.insertAdjacentHTML('beforeEnd', toastHTML);
						} else {
							alert.remove();
							loveYou.drawToast(message);
						}
						intervalCounter = setInterval("loveYou.hideToast()", 1000);
					},
					//取得cookie    
					getCookie: function(name) {
						var nameEQ = name + "=";
						var ca = document.cookie.split(';'); //把cookie分割成组    
						for (var i = 0; i < ca.length; i++) {
							var c = ca[i]; //取得字符串    
							while (c.charAt(0) == ' ') { //判断一下字符串有没有前导空格    
								c = c.substring(1, c.length); //有的话，从第二位开始取    
							}
							if (c.indexOf(nameEQ) == 0) { //如果含有我们要的name    
								return unescape(c.substring(nameEQ.length, c.length)); //解码并截取我们要值    
							}
						}
						return false;
					},
					//设置cookie    
					setCookie: function(name, value, seconds) {
						seconds = seconds || 0; //seconds有值就直接赋值，没有为0，这个跟php不一样。    
						var expires = "";
						if (seconds != 0) { //设置cookie生存时间    
							var date = new Date();
							date.setTime(date.getTime() + (seconds * 1000 * 24));
							expires = "; expires=" + date.toGMTString();
						}
						document.cookie = name + "=" + escape(value) + expires + "; path=/"; //转码并赋值    
					}, //清除cookie    
					clearCookie: function(name) {
						var exp = new Date();
						exp.setTime(exp.getTime() - 1);
						var cval = getCookie(name);
						if (cval != null)
							document.cookie = name + "=" + cval + ";expires=" + exp.toGMTString();
						loveYou.setCookie(name, "", -1);
					}
				}
				//				判断有没有之前点赞
			var flag_forty_five = loveYou.getCookie("flag_forty_five");
			var flag_forty_six = loveYou.getCookie("flag_forty_six");
			if (flag_forty_five) {
				$("#oppose img").attr("src", "http://cdn.icomicool.cn/m/act/201605/520/images/index_066.jpg");
			} else if (flag_forty_six) {
				$("#support img").attr("src", "http://cdn.icomicool.cn/m/act/201605/520/images/index_077.jpg");
			}
			//				下面的按钮点赞
			$("#zan ul").on("click", function() {
				var flag_forty_five = loveYou.getCookie("flag_forty_five");
				var flag_forty_six = loveYou.getCookie("flag_forty_six");
				//	loveYou.clearCookie("flag_forty_five")
				//	loveYou.clearCookie("flag_forty_six")
				var hasPraised = $(this).attr("id");
				if (flag_forty_five || flag_forty_six) {
					loveYou.drawToast("你好像表过态");
				} else {
					if (hasPraised == "oppose") {
						var num = $("#oppose span").html();
						$("#oppose span").html(parseInt(num) + 1);
						$("#oppose img").attr("src", "http://cdn.icomicool.cn/m/act/201605/520/images/index_066.jpg");
						$.get("http://comicool.cn/simple_vote.php?sel=45");
						loveYou.setCookie("flag_forty_five", "true", 300);
					} else {
						var num = $("#support span").html();
						$("#support span").html(parseInt(num) + 1);
						$("#support img").attr("src", "http://cdn.icomicool.cn/m/act/201605/520/images/index_077.jpg");
						$.get("http://comicool.cn/simple_vote.php?sel=46");
						loveYou.setCookie("flag_forty_six", "true", 300);
					}
				}
			})
			$.ajax({
				url: 'http://www.comicool.cn/simple_vote.php',
				dataType: "jsonp",
				data: {},
				jsonpCallback: "jsonp_match",
				success: function(data) {
					data.results[45]=data.results[45]?data.results[45]:0;
					data.results[46]=data.results[46]?data.results[46]:0;
					$("#oppose span").html(data.results[45]);
					$("#support span").html(data.results[46]);
				}
			})
		</script>
		<!-- 百度统计 -->
		<script>
			var _hmt = _hmt || [];
			(function() {
				var hm = document.createElement("script");
				hm.src = "//hm.baidu.com/hm.js?91ce1b276d999b0757a6bf47b0e86df6";
				var s = document.getElementsByTagName("script")[0];
				s.parentNode.insertBefore(hm, s);
			})();
		</script>
	</body>

</html>