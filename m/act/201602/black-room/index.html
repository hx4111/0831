<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>可米酱的爆料小黑屋</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
		<meta name="description" content="可米酱的爆料小黑屋">
		<script src="http://m.comicool.cn/m-common/js/init.js"></script>
		<link rel="stylesheet" href="http://at.alicdn.com/t/font_1447060501_1939075.css">
		<link rel="stylesheet" href="http://m.comicool.cn/act/act-common/css/common.css">
		<style type="text/css">
			@media screen and (min-width:640px) {
				html,
				body {
					width: 640px;
					margin: 0 auto;
					font-size: 40px !important;
				}
			}
			
			* {
				margin: 0;
				padding: 0;
			}
			
			ul,
			li {
				list-style: none;
			}
			
			.imglist img {
				width: 100%;
				display: table;
			}
			
			#lock {
				background: url(http://cdn.icomicool.cn/m/act/201602/black-room/images/index_07.jpg) #fe9292 no-repeat;
				background-size: 100%;
				height: 11rem;
				text-align: center;
			}
			
			#lock span {
				display: inline-block;
				width: 3rem;
				height: 3rem;
				margin: .5rem .2rem 1.4rem;
			}
			
			#praise {
				position: relative;
				width: 100%;
				overflow: hidden;
			}
			
			#praise span {
				position: absolute;
				left: 50%;
				transform: translateX(-50%);
				-webkit-transform: translateX(-50%);
				-moz-transform: translateX(-50%);
				-o-transform: translateX(-50%);
				-ms-transform: translateX(-50%);
				transform: translateX(-50%);
				top: 2rem;
				color: #ff4352;
				font-size: 1.3rem;
			}
			
			.hide {
				background: url(http://cdn.icomicool.cn/m/act/201602/black-room/images/lock.jpg) no-repeat;
				background-size: 100%;
			}
			
			.show {
				background: url(http://cdn.icomicool.cn/m/act/201602/black-room/images/undo.jpg) no-repeat;
				background-size: 100%;
			}
		</style>
	</head>

	<body>
		<!-- 一般化分享 -->
		<h1 class="thumbnails" style="display:none">
        可米酱的爆料小黑屋
        <p>可米酷不为人的二三四五六七事</p>
        <img src="http://cdn.icomicool.cn/m/act/201602/black-room/images/share.jpg">
    </h1>
		<div class="loading-spinner"></div>
		<header class="header header-fixed header-shadow">
			<a class="l-icon icon-home" href="http://m.comicool.cn"></a>
			<i class="r-icon icon-share"></i>
		</header>
		<!-- 主要内容：开始 -->
		<div class="imglist">
			<li><img src="http://cdn.icomicool.cn/m/act/201602/black-room/images/index_01.jpg" alt="可米酱的爆料小黑屋" /></li>
			<li><img src="http://cdn.icomicool.cn/m/act/201602/black-room/images/index_02.jpg" alt="可米酱的爆料小黑屋" /></li>
			<li><img src="http://cdn.icomicool.cn/m/act/201602/black-room/images/index_03.jpg" alt="可米酱的爆料小黑屋" /></li>
			<li><img src="http://cdn.icomicool.cn/m/act/201602/black-room/images/index_04.jpg" alt="可米酱的爆料小黑屋" /></li>
			<li><img src="http://cdn.icomicool.cn/m/act/201602/black-room/images/index_05.jpg" alt="可米酱的爆料小黑屋" /></li>
			<li id="praise"><span>0</span><img src="http://cdn.icomicool.cn/m/act/201602/black-room/images/index_06.jpg" alt="可米酱的爆料小黑屋" /></li>
			<li id="lock">
				<span data-epid="1"></span>
				<span data-epid="2"></span>
				<span data-epid="3"></span>
				<span data-epid="4"></span>
				<span data-epid="5"></span>
				<span data-epid="6"></span>
				<span data-epid="7"></span>
				<span data-epid="8"></span>
			</li>
			<li><img src="http://cdn.icomicool.cn/m/act/201602/black-room/images/index_08.jpg" alt="可米酱的爆料小黑屋" /></li>
			<li><img src="http://cdn.icomicool.cn/m/act/201602/black-room/images/index_09.jpg" alt="可米酱的爆料小黑屋" /></li>
			<li><img src="http://cdn.icomicool.cn/m/act/201602/black-room/images/index_10.jpg" alt="可米酱的爆料小黑屋" /></li>
			<li><img src="http://cdn.icomicool.cn/m/act/201602/black-room/images/index_11.jpg" alt="可米酱的爆料小黑屋" /></li>
			<li>
				<a href="http://m.comicool.cn/act/201602/happy/index.html" target="_blank"><img src="http://cdn.icomicool.cn/m/act/201602/black-room/images/index_12.jpg" alt="可米酱的爆料小黑屋" /></a>
			</li>
			<li><img src="http://cdn.icomicool.cn/m/act/201602/black-room/images/index_13.jpg" alt="可米酱的爆料小黑屋" /></li>
			<li><img src="http://cdn.icomicool.cn/m/act/201602/black-room/images/index_14.jpg" alt="可米酱的爆料小黑屋" /></li>
		</div>
		<!-- 主要内容：结束 -->
		<!-- 百度分享面板 -->
		<div id="ShareBg"></div>
		<div class="bdsharebuttonbox sharebox" data-tag="share_1">
			<div id="ShareCon">
				<em></em>
				<h2></h2>
			</div>
			<div>
				<a data-cmd="tsina"></a><i class="icon-xinlangweibo iconfont"></i>
				<a data-cmd="sqq"></a><i class="icon-qq iconfont" data-cmd="bds_sqq"></i>
				<a data-cmd="qzone"></a><i class="icon-qqkongjian iconfont" data-cmd="bds_qzone"></i>
				<a data-cmd="douban"></a><i class="icon-douban iconfont" data-cmd="bds_douban"></i>
			</div>
			<div class="share-clo">取消</div>
		</div>
		<script src="http://m.comicool.cn/m-common/js/app.js"></script>
		<script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
		<script>
			setShareInfo({
				title: '可米酱的爆料小黑屋',
				describe: '可米酷不为人的二三四五六七事',
				imageUrl: 'http://cdn.icomicool.cn/m/act/201602/black-room/images/share.jpg',
				pageUrl: window.location.href
			}, {
				use: 'baidu',
				init: initBaiduSharePanel
			});

			function initBaiduSharePanel() {
				var _ = function(selector, parent) {
						return (parent || document).querySelector(selector);
					},
					header = _('.header'),
					trigger = _('.icon-share', header),
					mask = _('#ShareBg'),
					panel = _('.bdsharebuttonbox'),
					cancelBtn = _('.share-clo', panel),
					panelTitle = _('#ShareCon h2'),
					panelImageCont = _('#ShareCon em'),
					panelImage = new Image(),
					hidePanel = function() {
						mask.style.display = panel.style.display = 'none';
					};
				header.style.display = 'block';
				panelTitle.innerHTML = this.title;
				panelImage.src = this.imageUrl;
				panelImageCont.appendChild(panelImage);
				trigger.addEventListener('click', function() {
					mask.style.display = panel.style.display = 'block';
				});
				mask.addEventListener('click', hidePanel);
				cancelBtn.addEventListener('click', hidePanel);
			}
			var lock = document.getElementById("lock").getElementsByTagName("a");
			$.ajax({
				url: 'http://comicool.cn/simple_vote.php',
				dataType: "jsonp",
				data: {},
				jsonpCallback: "jsonp_match",
				success: function(data) {
					var praise = data.results[1];
					$("#praise span").html(praise);
					for (var i = 1, len = $("#lock span").length; i < len; i++) {
						lockHref(i, praise);
					}
					bindOpenComicEvents();
				}
			})

			function bindOpenComicEvents() {
				var readComic;
				if (isAndroidApp) {
					readComic = function(epid) {
						callAppFunction('openEpisodeReaderPage', {
							comic_id: 10939,
							ep_id: epid
						});
					}
				} else if (isIOS) {
					readComic = function(epid) {
						if (epid == "1") {
							callAppFunction('openEpisodeReaderPage', {
								comic_id: 10939,
								ep_id: epid
							});
						} else {
							callAppFunction('openNewBrowser', {
								"url": 'http://m.comicool.cn/content/reader.html?comic_id=10939&ep_id=' + epid,
								"title": "可米酱的爆料小黑屋"
							});
						}
					}
				} else {
					readComic = function(epid) {
						window.location.href = 'http://m.comicool.cn/content/reader.html?comic_id=10939&ep_id=' + epid;
					}
				}
				$("#lock span").on('click', function(e) {
					var epid = this.dataset.epid;
					if (epid !== undefined && epid !== "") {
						readComic(epid);
					} else {
						alert("加把劲，攒够赞数就开启!")
					}
				});
			}

			function lockHref(index, praise) {
				var num = parseInt(index + "000");
				if (praise >= num) {
					$("#lock span").eq(index).addClass("show");
				} else {
					$("#lock span").eq(index).addClass("hide");
					$("#lock span").eq(index).attr("data-epid", "");
				}
			}
			if (!getCookie('flag')) {
				var flag = false;
			}
			$("#praise").on("click", function() {
					//				clearCookie("flag")
					if (getCookie('flag') == "true") {
						alert("您已经点过赞了!")
					} else {
						var num = $("#praise span").html();
						$("#praise span").html(parseInt(num) + 1);
						$.get("http://comicool.cn/simple_vote.php?sel=1");
						setCookie("flag", "true", 30)
					}
				})
				//取得cookie    
			function getCookie(name) {
				var nameEQ = name + "=";
				var ca = document.cookie.split(';'); //把cookie分割成组    
				for (var i = 0; i < ca.length; i++) {
					var c = ca[i]; //取得字符串    
					while (c.charAt(0) == ' ') { //判断一下字符串有没有前导空格    
						c = c.substring(1, c.length); //有的话，从第二位开始取    
					}
					if (c.indexOf(nameEQ) == 0) { //如果含有我们要的name    
						return unescape(c.substring(nameEQ.length, c.length)); //解码并截取我们要值    
					}
				}
				return false;
			}
			//清除cookie    
			function clearCookie(name) {
				setCookie(name, "", -1);
			}
			//设置cookie    
			function setCookie(name, value, seconds) {
				seconds = seconds || 0; //seconds有值就直接赋值，没有为0，这个根php不一样。    
				var expires = "";
				if (seconds != 0) { //设置cookie生存时间    
					var date = new Date();
					date.setTime(date.getTime() + (seconds * 1000 * 360 * 24 * 365));
					expires = "; expires=" + date.toGMTString();
				}
				document.cookie = name + "=" + escape(value) + expires + "; path=/"; //转码并赋值    
			}
			//获取页面URL参数名
			function getQueryString(name) {
				var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
				var r = window.location.search.substr(1).match(reg);
				if (r != null) return decodeURI(r[2]);
				return null;
			};
		</script>
		<!--百度统计-->
		<script>
			var _hmt = _hmt || [];
			(function() {
				var hm = document.createElement("script");
				hm.src = "//hm.baidu.com/hm.js?91ce1b276d999b0757a6bf47b0e86df6";
				var s = document.getElementsByTagName("script")[0];
				s.parentNode.insertBefore(hm, s);
			})();
		</script>
	</body>

</html>