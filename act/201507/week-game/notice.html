<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>可米酷漫画周赛参赛作品预告|漫画网_二次元</title>
<meta name="keywords" content="漫画周赛,作品预告,漫画网,二次元,在线漫画,看漫画,条漫,可米酷漫画" />
<meta name="description" content="可米酷漫画周赛预告：又有哪些新画师即将登场？拉票从今天开始！" />
<link rel="shortcut icon" type="image/x-icon" href="http://www.comicool.cn/images/favicon.ico" media="screen" />
<link rel="stylesheet" type="text/css" href="css/style.css">
<style type="text/css">
body { background:url(images/notice/bg.png) center top repeat;}
.notice { color: #222222; width: 1076px; margin: auto;}
.notice-top { height: 677px; text-align: center; background:url(images/notice/top.jpg) no-repeat;}
.notice-t1 { height: 157px; padding: 162px 0 100px 667px;}
.notice-t2 { height: 66px; padding-left: 581px;}
.notice-t1 span { display: block; width: 157px; height: 157px; line-height: 156px; font-size: 100px; color: #fff;}
.notice-t2 span { display: block; width: 274px; height: 66px; line-height: 66px; font-size: 30px; color: #228AFF;}
.notice-main { width: 784px; min-height: 200px; margin: auto;}
.notice-main.loading { background:url(images/loading.gif) center center no-repeat;}
ul.main-list li { width: 630px; overflow: hidden; border:6px solid #4fb8fa; padding: 48px 71px 40px; background-color: #fff; margin-bottom: 45px; font-size: 16px;}
ul.main-list li.li-last { margin-bottom: 0;}
ul.main-list .li-con { width: 630px; height: 497px; overflow: hidden; border-radius: 6px;}
ul.main-list .li-con .li-img { width: 630px; height: 420px; overflow: hidden;}
ul.main-list .li-con .li-img img { width: 100%; height: 100%;}
ul.main-list .li-con .li-title { background:url(images/notice/li-tit-bg.png) repeat; height: 77px; text-align: center; line-height: 74px; font-size: 20px; color: #fff;}
ul.main-list .li-con .li-title span { color: #fff; display: inline-block; *zoom: 1; *display: inline; height: 46px; line-height: 46px; background:url(images/notice/li-btn-icon.png) right center no-repeat; padding:0 35px 0 15px;}
ul.main-list h3.li-author { padding: 11px 0; line-height: 36px; height: 36px;}
ul.main-list h3.li-author i { display: inline-block; *zoom: 1; *display: inline; margin-right: 5px; width: 36px; height: 36px;}
ul.main-list h3.li-author em { font-style: normal;}
ul.main-list h3.li-author img { vertical-align: top; width: 100%; height: 100%; border-radius: 50%;}
ul.main-list p { padding-top: 11px; line-height: 24px;}

.notice-bottom { padding-top: 34px;}
.notice-bottom h1 { padding-bottom:38px;}
ul.bottom-list { padding-left: 17px; padding-bottom: 30px;}
ul.bottom-list li { width: 159px; height: 215px; padding-bottom: 20px; float: left; position: relative; text-align: center; color: #fff; margin-left: 68px;}
ul.bottom-list li .li-img-bg { width: 159px; height: 159px; position: relative; z-index: 50; background:url(images/notice/bot-li-img.png) no-repeat;}
ul.bottom-list li .li-img-bg a { display: block; width: 100%; height: 100%;}
ul.bottom-list li .li-img-bg p { width: 159px; line-height: 159px; color: #9b9b9b; font-size: 30px;}
ul.bottom-list li .li-img { position: absolute; top: 3px; left: 3px; width: 153px; height: 153px; display: none;}
ul.bottom-list li .li-img img { width: 100%; height: 100%;}
ul.bottom-list li .li-date { width: 138px; height: 42px; line-height: 42px; margin: auto; background:url(images/notice/bot-li-date.png) no-repeat; font-size: 24px; display: none; margin-top: 14px;}
ul.bottom-list li.curr .li-img-bg { background-position: right top;}
ul.bottom-list li.curr .li-img-bg p { padding-top: 119px; line-height: 38px; color: #fff; font-size: 18px;}
ul.bottom-list li.curr .li-img { display: block;}
ul.bottom-list li.curr .li-date { display: block;}

.errorbox { text-align: center; padding-top: 60px; font-size: 18px}
.error-btn { padding-top: 20px;}
.error-btn a { display: inline-block; vertical-align: top; *zoom: 1; *display: inline; border:1px dashed #666; line-height: 30px; padding: 0 10px; color: #888;}

.notice-main-top, .notice-bottom { display: none;}
</style>
</head>
<body>
    <div class="pagebox notice">
        <div class="notice-top">
            <div class="notice-t1">
                <span></span>
            </div>
            <div class="notice-t2">
                <span></span>
            </div>
        </div>
        <div class="notice-main">
            <div class="notice-main-top">
                <!-- <ul class="main-list">
                    <li>
                        <div class="li-con">
                            <div class="li-img">
                                <img src="images/notice/li-img.jpg" alt="参赛作品预告" />
                            </div>
                            <div class="li-title">
                                <a>巴拉巴拉小魔仙</a>
                            </div>
                        </div>
                        <h3 class="li-author">
                            <i><img src="images/default-img.png" /></i>
                            <em>作者作者</em>
                        </h3>
                        <p>巴拉巴拉小魔仙巴拉巴拉小魔仙巴拉巴拉小魔仙巴拉巴拉小魔仙巴拉小魔仙巴拉巴拉小魔仙巴拉巴拉小魔仙巴拉巴拉小魔仙巴拉巴拉小魔仙巴拉小魔仙</p>
                    </li>
                </ul> -->
            </div>
            <!-- <div class="notice-bottom">
                <h1><img src="images/notice/title.png" alt="漫画周赛,漫画网,二次元" /></h1>
                <ul class="bottom-list cl">
                    <li>
                        <div class="li-img-bg">
                            <a href="javascript:;">
                                <p>第1期</p>
                            </a>
                        </div>
                        <div class="li-img">
                            <img src="images/notice/bot-li-img.jpg" alt="参赛作品预告" />
                        </div>
                        <div class="li-date">
                            <span>5.1-5.7</span>
                        </div>
                    </li>
                    <li class="curr">
                        <div class="li-img-bg">
                            <a href="javascript:;">
                                <p>第2期</p>
                            </a>
                        </div>
                        <div class="li-img">
                            <img src="images/notice/bot-li-img.jpg" alt="参赛作品预告" />
                        </div>
                        <div class="li-date">
                            <span>5.1-5.7</span>
                        </div>
                    </li>
                </ul>
            </div> -->
        </div>
    </div>
</body>
<script src="http://www.comicool.cn/js/jquery-1.8.3.min.js" type="text/javascript"></script>
<script type="text/javascript">
var dataListHtml = '';
var bottomHtml = '';
function ajaxRequest() {
    $.ajax({
        url: 'http://proxy.icomico.com/league4web',  //测试：http://121.201.7.97/ 正式：http://proxy.icomico.com/
        data: {
            league_status: 'later'
        },
        type: 'GET',
        timeout: 6000,
        dataType: 'jsonp',
        jsonp: 'callback',
        jsonpCallback: 'jsonp_league',
        beforeSend: function(){
            // $('.loading').show();
            $('.notice-main').addClass('loading');
        },
        success: function(data){
            console.log(data);
            if( data.msg == 'success'){
                $('.notice-main-top, .notice-bottom').show();

                for (var i = 0, len = data.ep_list.length; i < len; i++) {
                    var comiData = data.ep_list[i];
                    var imgUrl = 'http://cdn.icomico.com/' + comiData.ep_poster;
                    var imgAlt = '漫画周赛,作品预告';
                    var title = comiData.ep_title;
                    var author = comiData.author_name;
                    var authorIcon = comiData.author_icon;
                    var authorIconAlt = author + ',参赛作品';
                    var desc = comiData.desc;

                    if (!!title && !!comiData.ep_poster) {
                        dataListHtml +='<li>'
                                     +   '<div class="li-con">'
                                     +       '<div class="li-img">'
                                     +          '<img src="' + imgUrl + '?imageView2/2/w/630" alt="' + imgAlt + '" />'
                                     +       '</div>'
                                     +       '<div class="li-title">'
                                     +           '<span>' + title + '</span>'
                                     +       '</div>'
                                     +   '</div>'
                                     +   '<h3 class="li-author">'
                                     +       '<i><img src="' + authorIcon + '" alt="' + authorIconAlt + '" /></i>'
                                     +       '<em>' + author + '</em>'
                                     +   '</h3>'
                                     +   '<p>' + desc + '</p>'
                                     + '</li>'
                    }
                };

                dataListHtml = '<ul class="main-list">' + dataListHtml + '</ul>'
                $('.notice-main-top').html(dataListHtml);

                $.each($('.main-list .li-author img'), function(i){
                    $('.main-list .li-author img')[i].onerror = function() {
                        $(this).attr('src', 'images/default-img.png');
                    }
                });

                $('.notice-t1 span').text(data.league_info.league_order);
                $('.notice-t2 span').text(data.league_info.league_date);

                //data.league_info.league_order = 3;
                //alert(data.league_info.league_order);

                //底部数据 ago_list 存在数据显示
                if ( data.ago_list != null) {
                    //$('.notice-bottom').show();
                    var bottomListLen = data.ago_list.length;
                    //alert(bottomListLen);
                    for ( var j = 0; j < bottomListLen; j++) {
                        var botData = data.ago_list[j];
                        var botDate = botData.league_date;
                        var botOrder = botData.league_order;
                        var botCover = botData.league_icon;
                        var botCover = 'http://cdn.icomico.com/' + botData.champion_comico_cover;
                        bottomHtml +='<li class="curr">'
                                   +     '<div class="li-img-bg">'
                                   +         '<a href="javascript:;">'
                                   +             '<p>第' + botOrder + '期</p>'
                                   +         '</a>'
                                   +     '</div>'
                                   +     '<div class="li-img">'
                                   +         '<img src="' + botCover + '?imageView2/1/w/153/h/153" alt="漫画周赛,获奖作品" />'
                                   +     '</div>'
                                   +     '<div class="li-date">'
                                   +         '<span>' + botDate + '</span>'
                                   +     '</div>'
                                   + '</li>'
                    }

                    //var liImgDefault = '<img src="images/bot-default.jpg" alt="漫画周赛,获奖作品" />';
                    $('.bottom-list').html(bottomHtml);
                    var liImgDefault = 'images/bot-default.jpg';
                    $('.bottom-list li .li-img img').each(function (i){
                        //console.log(this)
                        this.onerror = function (){
                             this.src = liImgDefault;
                        }

                        //另一种写法
                        /*$(this).on('error', function (){
                            $(this).attr('src', liImgDefault);
                        });*/
                    });
                    $('.bottom-list li .li-img-bg').on('click', function(){
                        var sendIndex = $(this).parents('li').index() + 1;
                        window.location.href = 'awards-pub.html?league_order=' + sendIndex;
                    });
                };  //底部数据结束
            } else {
                errorFn();
            }
        },
        complete: function(){
            //$('.loading').hide();
            $('.notice-main').removeClass('loading');
            //errorFn();
        },
        error: function(){
            errorFn();
        }
    });
}
ajaxRequest();

function errorFn() {
    var errorHtml = ''
                  +  '<div class="errorbox">'
                  +     '<p>加载中出现错误啦！~>(0_0)<~</p>'
                  +     '<div class="error-btn">'
                  +         '<a href="javascript:;">重新加载</a>'
                  +     '</div>'
                  +  '</div>';
    $('.notice-main-top, .notice-bottom').hide();
    $('.notice-main').append(errorHtml);
    $('.error-btn a').on('click', function(){
        $('.notice-main').html('');
        ajaxRequest();
    });
}

//百度统计代码安装
var _hmt = _hmt || [];
(function() {
var hm = document.createElement("script");
hm.src = "//hm.baidu.com/hm.js?91ce1b276d999b0757a6bf47b0e86df6";
var s = document.getElementsByTagName("script")[0]; 
s.parentNode.insertBefore(hm, s);
})();
</script>
</html>